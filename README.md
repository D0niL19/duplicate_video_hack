# 4PANDAS: Видео Дубликаты API

Этот проект предоставляет сервис для поиска дубликатов видео. Сервис использует современные технологии, такие как Hugging Face, ONNX, Pytorch, Triton, FAISS и FastAPI, для извлечения признаков аудио и видео из входных данных и их дальнейшей обработки для определения дубликатов.

## Технологический стек

Для реализации решения использовались следующие технологии и инструменты:
- Hugging Face — для моделей машинного обучения.
- ONNX — для оптимизации и переноса моделей.
- Pytorch — для работы с нейронными сетями и обучением моделей.
- Triton — для высокопроизводительного сервинга моделей.
- FAISS — для быстрого поиска по векторным представлениям.
- FastAPI — для создания API сервиса.

## Архитектура решения

1. API принимает ссылку на видео.
2. Видео скачивается в виде потока байтов и передаётся на Triton-сервер через gRPC.
3. На Triton сервере видео обрабатывается с использованием двух экстракторов:
   - Audio Feature Extractor — для извлечения аудио признаков.
   - Video Feature Extractor — для извлечения видео признаков.
4. Извлечённые признаки передаются в систему поиска, основанную на FAISS, для определения схожести с ранее загруженными видео.

## Метрики

- Точность определения дубликатов: 80%
- Среднее время обработки видео: 1100 мс на видеофайл

[//]: # (- Пропускная способность сервиса: до 1000 видеофайлов в минуту)

## Установка и запуск

### Шаги установки

1. Загрузка Docker-образов

   Перед запуском необходимо загрузить нужные Docker-образы для Triton и моделей машинного обучения:
   
      docker pull <your-custom-image>  # Замените на нужный образ
   

2. Запуск с Docker Compose

   Настройте и запустите сервисы с помощью Docker Compose. Пример файла docker-compose.yml:
```
version: '3.8'
   services:
     api:
       image: <your-api-image>
       ports:
         - "8000:8000"
       environment:
         - TRITON_SERVER_URL=triton:8001
     triton:
       image: <your-triton-image>
       ports:
         - "8001:8001"
```

3. Запуск проекта

   После настройки Docker Compose, запустите проект командой:

      docker-compose up
   

### Пример запроса к API

После запуска сервис будет доступен на http://localhost:8000. Пример запроса на определение дубликата видео:

curl -X POST "89.169.154.167:8080/check-video-duplicate" \
-H "Content-Type: application/json" \
-d '{"video_url": "https://s3.ritm.media/yappy-db-duplicates/video_id.mp4}'

Ответ будет содержать результат сравнения видео с уже существующими в базе данных.
\
Пример результата:
```
{
    "is_duplicate": false,
    "duplicate_for": ""
}
```
```
{
    "is_duplicate": true,
    "duplicate_for": "22d891cc-563a-48c9-9b6e-368829598e91"
}
```
## Контакты

Если у вас возникли вопросы или предложения, вы можете связаться с нами по следующим контактам:
- Telegram: [@D0niL19](https://t.me/D0niL19)  [@Wortex04](https://t.me/Wortex04) [@AzamatSibgatullin]((https://t.me/AzamatSibgatullin))
]
